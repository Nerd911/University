#include <stdio.h>
#include <stdbool.h>
#include <string.h>

char masks[] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 32, 34, 36, 38, 40, 42, 48, 50, 52, 54, 56, 58};
char bits[] =  {0, 1, 1, 2, 1, 2, 2, 3, 1, 2,  2,  3,  1,  2,  2,  3,  2,  3,  3,  4,  2,  3,  3,  4,  1,  2,  2,  3,  2,  3,  2,  3,  3,  4,  3,  4};
char stateTables[36][500003];
char chessboard[1000001][4];
char goodmasks[][36] = {
{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, },
{0, 1, 4, 5, 8, 9, 12, 13, 16, 17, 20, 21, 24, 26, 28, 30, 32, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 8, 10, 12, 14, 20, 22, 24, 25, 28, 29, 30, 31, 34, 35, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 8, 12, 20, 24, 28, 30, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 4, 5, 8, 9, 12, 13, 16, 17, 20, 21, 24, 26, 28, 30, 32, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 4, 5, 8, 9, 12, 13, 16, 17, 20, 21, 24, 26, 28, 30, 32, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 8, 12, 20, 24, 28, 30, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 8, 12, 20, 24, 28, 30, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 2, 3, 8, 9, 10, 11, 24, 25, 28, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 8, 9, 24, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 8, 10, 24, 25, 28, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 8, 24, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 2, 3, 4, 5, 6, 7, 12, 13, 14, 15, 16, 17, 18, 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 4, 5, 12, 13, 16, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 12, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 4, 5, 12, 13, 16, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 4, 5, 12, 13, 16, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 4, 6, 8, 10, 24, 25, 26, 27, 28, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 8, 10, 24, 25, 28, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 4, 8, 24, 26, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 8, 24, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 8, 10, 24, 25, 28, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 8, 10, 24, 25, 28, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
{0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};
char goodmaskcnt[] = {36, 18, 16, 8, 18, 18, 8, 8, 12, 6, 8, 4, 16, 8, 4, 2, 8, 8, 2, 2, 4, 2, 2, 1, 12, 8, 6, 4, 8, 8, 4, 2, 2, 1, 2, 2, };

void setBits(int i, char mask){
  if(mask&32)
    chessboard[i-1][2] = 'S';
  if(mask&16)
    chessboard[i-1][1] = 'S';
  if(mask&8)
    chessboard[i-1][0] = 'S';
  if(mask&4)
    chessboard[i][2] = 'S';
  if(mask&2)
    chessboard[i][1] = 'S';
  if(mask&1)
    chessboard[i][0] = 'S';
}

void swapPtrs(int** p0, int** p1){
  int* temp;
  temp = *p1;
  *p1 = *p0;
  *p0 = temp;
}

bool checkMask(int i, int j){
  if(
    ((masks[j]&1) && chessboard[i][0] != '.') ||
    ((masks[j]&2) && chessboard[i][1] != '.') ||
    ((masks[j]&4) && chessboard[i][2] != '.') ||
    ((masks[j]&8) && chessboard[i-1][0] != '.') ||
    ((masks[j]&16) && chessboard[i-1][1] != '.') ||
    ((masks[j]&32) && chessboard[i-1][2] != '.')
  ) return false;
  return true;
}

int check(int m){
  int count = 0;
  int state0[36] = {0};
  int state1[36] = {0};

  int* curstate = state0;
  int* prevstate = state1;

  int i, j, k;
  for(i = 1; i <= m; i += 2){
    for(j = 0; j < 36; ++j){
      if(checkMask(i, j)){
        count = -1;
        for(k = 0; k < goodmaskcnt[j]; ++k){
          if(prevstate[(int)goodmasks[j][k]] > count){
            count = prevstate[(int)goodmasks[j][k]];
            stateTables[j][i/2] = goodmasks[j][k];
          }
        }
        curstate[j] = count + bits[j];
      }
      else{
        curstate[j] = -1;
      }
    }

    swapPtrs(&curstate, &prevstate);
  }
  int best;
  count = -1;

  for(i = 0; i < 36; ++i){
    if(prevstate[i] > count){
      count = prevstate[i];
      best = i;
    }
  }

  for(i = m - ((m+1)%2); i > 0; i-=2){
    setBits(i, masks[best]);
    best = stateTables[best][i/2];
  }

  return count;
}
int main(){
  int n;
  int i;
  scanf("%d", &n);
  for(i = 0; i < n; ++i){
    scanf("%s\n", chessboard[i]);
  }
  memcpy(chessboard[n], "xxx", 4);
  printf("%d\n", check(n));
  for(i = 0; i < n; ++i){
    printf("%s\n", chessboard[i]);
  }
  return 0;
}
